#!/bin/bash
# Script para actualizar el servidor EC2 con package-lock.json incluido

echo "üîß Actualizando servidor EC2 con package-lock.json incluido..."
echo "============================================================"

# Configuraci√≥n
EC2_IP="3.141.40.201"
EC2_USER="ubuntu"

echo "‚ö†Ô∏è  Necesitas ejecutar estos comandos manualmente en el servidor EC2:"
echo ""
echo "1. Conectarse al servidor:"
echo "   ssh -i tu-clave.pem ubuntu@${EC2_IP}"
echo ""
echo "2. Ir al directorio del proyecto:"
echo "   cd /home/ubuntu/vantage-backend"
echo ""
echo "3. Actualizar c√≥digo desde GitHub (incluye package-lock.json):"
echo "   git pull origin main"
echo ""
echo "4. Limpiar cach√© de Next.js:"
echo "   cd vantageai-frontend"
echo "   rm -rf .next"
echo "   cd .."
echo ""
echo "5. Reconstruir contenedores Docker (ahora con package-lock.json):"
echo "   docker compose down"
echo "   docker compose up --build -d"
echo ""
echo "6. Esperar que los servicios est√©n listos (30 segundos):"
echo "   sleep 30"
echo ""
echo "7. Verificar estado:"
echo "   docker compose ps"
echo "   curl http://localhost:5002/health"
echo ""
echo "‚úÖ Despu√©s de estos pasos, el dise√±o completo deber√≠a funcionar en:"
echo "   http://${EC2_IP}:3000"
echo ""
echo "üîß PROBLEMA SOLUCIONADO:"
echo "   - Se agreg√≥ package-lock.json al repositorio"
echo "   - Docker build ahora funcionar√° correctamente"
echo "   - npm ci tendr√° las dependencias bloqueadas"
echo ""
echo "üé® NUEVAS CARACTER√çSTICAS DE DISE√ëO:"
echo ""
echo "   PRODUCTOS:"
echo "   - Gradiente azul/p√∫rpura en tarjetas"
echo "   - Badges destacados con estrellas doradas"
echo "   - Animaciones hover con transform"
echo "   - SKU badges mejorados"
echo "   - Informaci√≥n estructurada en cajas"
echo "   - Precios destacados en verde"
echo ""
echo "   SERVICIOS:"
echo "   - Gradiente p√∫rpura/rosa en tarjetas"
echo "   - Iconos de llave inglesa"
echo "   - Badges de modalidad mejorados"
echo "   - Mismas animaciones que productos"
echo "   - Precios destacados en p√∫rpura"
echo ""
echo "   MEJORAS GENERALES:"
echo "   - Skeletons precisos sin saltos"
echo "   - Lazy loading optimizado"
echo "   - Bordes redondeados (rounded-2xl)"
echo "   - Sombras mejoradas (hover:shadow-xl)"
echo "   - Tipograf√≠a mejorada"
echo "   - Espaciado estructurado"
echo ""
echo "üß™ Para probar el dise√±o completo:"
echo ""
echo "   1. Ve a http://${EC2_IP}:3000"
echo "   2. Inicia sesi√≥n con: cliente1@mineraandes.cl / password123"
echo "   3. Navega a:"
echo "      - Productos: /client/products"
echo "      - Servicios: /client/services"
echo "   4. Prueba los filtros y b√∫squedas"
echo "   5. Observa las animaciones hover"
echo ""
echo "üìã CAMBIOS IMPLEMENTADOS:"
echo "‚úÖ Onboarding completo (cliente y proveedor)"
echo "‚úÖ Dise√±o moderno de tarjetas"
echo "‚úÖ Animaciones y efectos visuales"
echo "‚úÖ Lazy loading optimizado"
echo "‚úÖ Skeletons precisos"
echo "‚úÖ Responsive design"
echo "‚úÖ TypeScript interfaces"
echo "‚úÖ Performance optimizations"
echo "‚úÖ package-lock.json incluido"
echo ""
echo "üéØ NO SE NECESITAN MIGRACIONES:"
echo "   - Solo cambios de frontend"
echo "   - Backend sin modificaciones"
echo "   - Base de datos sin cambios"
echo ""
echo "üîß DOCKER BUILD FIXED:"
echo "   - package-lock.json ahora disponible"
echo "   - npm ci funcionar√° correctamente"
echo "   - Dependencias bloqueadas para consistencia" 