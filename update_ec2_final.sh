#!/bin/bash

# Script final para actualizar el servidor EC2 con onboarding funcionando
echo "üöÄ Actualizando servidor EC2 con onboarding completo..."

# Configuraci√≥n
EC2_IP="3.141.40.201"
EC2_USER="ubuntu"

echo "üì° Conectando a EC2..."
echo "‚ö†Ô∏è  Necesitas ejecutar estos comandos manualmente en el servidor EC2:"
echo ""
echo "1. Conectarse al servidor:"
echo "   ssh -i tu-clave.pem ubuntu@3.141.40.201"
echo ""
echo "2. Ir al directorio del proyecto:"
echo "   cd /home/ubuntu/vantage-backend"
echo ""
echo "3. Actualizar c√≥digo desde GitHub:"
echo "   git pull origin main"
echo ""
echo "4. Limpiar cach√© de Next.js:"
echo "   cd vantageai-frontend"
echo "   rm -rf .next"
echo "   cd .."
echo ""
echo "5. Reconstruir contenedores Docker:"
echo "   docker compose down"
echo "   docker compose up --build -d"
echo ""
echo "6. Esperar que los servicios est√©n listos (30 segundos):"
echo "   sleep 30"
echo ""
echo "7. Verificar estado:"
echo "   docker compose ps"
echo "   curl http://localhost:5002/health"
echo ""
echo "‚úÖ Despu√©s de estos pasos, el onboarding deber√≠a funcionar en:"
echo "   http://3.141.40.201:3000"
echo ""
echo "üß™ Para probar:"
echo "   1. Ve a http://3.141.40.201:3000"
echo "   2. Inicia sesi√≥n con:"
echo "      - Cliente: cliente1@mineraandes.cl / password123"
echo "      - Proveedor: juan.perez@solucioneshidraulicas.cl / password123"
echo "   3. Deber√≠as ver el onboarding autom√°ticamente" 